<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analizzatore Cifrario di Cesare | Homework #02</title>
    <!-- Load Tailwind CSS for the styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!--For using Latex-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" xintegrity="sha384-wn8B7AL26CNhggS8g2R38d9A34c/A/37k2b1n2/zT9P/3G62Y6G03T4FwB5RjA6A" crossorigin="anonymous">

    <style>
        /*CSS Styles*/
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f4f7f9; 
            min-height: 100vh; 
        }
        .container { 
            max-width: 900px; 
        }
        textarea { 
            resize: none; 
            transition: all 0.2s; 
        }
        textarea:focus { 
            outline: none; 
            box-shadow: 0 0 0 3px rgba(234, 88, 12, 0.4); 
        }
        
        .markdown-container h1 { font-size: 2.5rem; font-weight: 700; margin-top: 1.5rem; }
        .markdown-container h2 { font-size: 2rem; font-weight: 600; margin-top: 2rem; border-bottom: 1px solid #ddd; padding-bottom: 0.5rem;}
        .markdown-container h3 { font-size: 1.5rem; font-weight: 600; margin-top: 1.5rem; }
        .markdown-container p, .markdown-container ul { margin-top: 1rem; line-height: 1.6; }
        .markdown-container strong { font-weight: 700; }
        .markdown-container code { background-color: #e9e9e9; padding: 2px 4px; border-radius: 4px; }
        .markdown-container pre { background-color: #f4f4f4; padding: 15px; border-radius: 8px; overflow-x: auto; margin-top: 1rem; }
        .markdown-container ul { list-style-type: disc; margin-left: 20px; padding-left: 10px; }
    
        /* Stile per il messaggio di feedback di copia */
        #copyFeedback {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(20px);
        }
        #copyFeedback.show {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
    <!-- Script KaTeX for LaTeX visualization -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" xintegrity="sha384-hdn6I5HhD1fV/A8/k+x+Gf8XW2Y+2G6M3qfX8S6F9L/Y6n6p8O7Z4d4p4f4N4d4" crossorigin="anonymous"></script>
    <!-- Auto-render for LaTex -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" xintegrity="sha384-y73x8fI7L8oEaXz9PZ9Bq9p6jR6E0/o+l/E6J/P/3G62Y6P9I7O7P4N4d4" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body class="p-4 sm:p-8">

    <div class="container mx-auto bg-white p-6 sm:p-10 rounded-xl shadow-2xl">
        
        <div class="markdown-container">
            <h1 class="text-orange-600">&#x1F4DD; Homework #02</h1>
            <hr style="border: none; border-top: 1px solid #ccc; margin: 20px 0;">
        
            <h2>Explain the concept of <strong>dataset</strong> and <strong>distribution</strong></h2>
            <hr style="border: none; border-top: 1px solid #ccc; margin: 20px 0;">
        
            <h3>Dataset</h3>
            <p>A dataset is a matrix in which:</p>
            <ul style="list-style-type: disc; margin-left: 20px;">
                <li>The rows are the <strong>statistical units</strong>: the things we want to study.</li>
                <li>The columns are their <strong>variables</strong>: the attributes of the statistical units we interested in, operationalized in some way.</li>
            </ul>
        
            <h3>Distribution</h3>
            <p>A distribution rapresent the way in which a certain variable manifests itselfe in a dataset</p>
        
            <p>In <strong>Descriptive Statistics</strong> a distribution rapresents the <em>frequency</em> in which diffents values of a variable manifest themselfe in a dataset. A distribution can be univariate, concerning just one attribute, bivariate, considering two variables, or multivariate.</p>
        
            <p>In <strong>Inferential Satistics</strong> a distribution rapresents all the possible values a certain variable can assume with the probability that value accours. It is a mathematical model binding a specific probability for each possible value.</p>
        
            <div style="margin: 40px 0;"></div>
            <hr style="border: none; border-top: 1px solid #ccc; margin: 20px 0;">
        
            <h2>Using a DBMS create a simple dataset. Compute the univariate distribution.</h2>
            <h3 class="text-yellow-600">&#x1F3C6;<em>For champions: compute a bivariate distribution</em></h3>
            <hr style="border: none; border-top: 1px solid #ccc; margin: 20px 0;">
        
            <p>Using MariaDB I've created a simple dataset containing the heights, the eye color and hair color of a group of people:</p>
        
            <p style="text-align: center;">
                <img src="../images/dataset.png" alt="Esempio di dataset" style="max-width: 100%; height: auto;">
            </p>
        
            <h3>Univariate Distributions</h3>
            <p>The following tables show the univariate distribution for each variable.
            These distributions were obtained running the following SQL queries:</p>
        
            <pre><code style="color: #333;">SELECT
	&lt;attribute&gt;,
	COUNT(&lt;attribute&gt;) AS frequency
FROM
	`homework-01`
GROUP BY
	&lt;attribute&gt;</code></pre>
        
            <div class="flex justify-center flex-wrap my-5 space-x-2  items-start">
                <img src="../images/height.png" class="w-full max-w-[calc(25%-10px)] min-w-[150px] my-1.5 h-auto object-contain">
                <img src="../images/eye_color.png" class="w-full max-w-[calc(25%-10px)] min-w-[150px] my-1.5 h-auto object-contain">
                <img src="../images/hair_color.png" class="w-full max-w-[calc(25%-10px)] min-w-[150px] my-1.5 h-auto object-contain">
            </div>
        
        
            <h3>Bivariate Distributions</h3>
            <p>The following tables show the bivariate distribution for each couple of variables.
            These distributions were obtained running the following SQL queries:</p>
        
            <pre><code style="color: #333;">SELECT
    &lt;attribute1&gt;,
    &lt;attribute2&gt;,
    COUNT(*) AS frequency
FROM
    `homework-01`
GROUP BY
    &lt;attribute1&gt;,
    &lt;attribute2&gt;
ORDER BY
    &lt;attribute1&gt; ASC, frequency DESC</code></pre>
        
            <!--<div style="display: flex; justify-content: space-around; flex-wrap: wrap; margin: 20px 0;">
                <img src="../images/height-eye_color.png" style="width: 30%; min-width: 150px; margin: 5px;">
                <img src="../images/height-hair_color.png" style="width: 30%; min-width: 150px; margin: 5px;">
                <img src="../images/eye_color-hair_color.png" style="width: 30%; min-width: 150px; margin: 5px;">
            </div> -->
            <div class="flex justify-center flex-wrap my-5 space-x-2 items-start">
                <img src="../images/height-eye_color.png" class="w-full max-w-[calc(30%-10px)] min-w-[150px] my-1.5 h-auto object-contain">
                <img src="../images/height-hair_color.png" class="w-full max-w-[calc(30%-10px)] min-w-[150px] my-1.5 h-auto object-contain">
                <img src="../images/eye_color-hair_color.png" class="w-full max-w-[calc(30%-10px)] min-w-[150px] my-1.5 h-auto object-contain">
            </div>

        </div>
        
        <!-- ########################################## -->
        <!-- CEASAR CIPHER -->
        <div style="height: 100px;"></div>
        
        <h1 class="text-3xl font-bold text-gray-800 my-8 pt-4 border-t border-gray-400 text-orange-600">
            Ceasar Cipher Decryption Through Frequency Analysis
        </h1>

        <!-- ENCRYPTION -->
        <h2 class="text-2xl font-bold text-gray-800 mb-4 text-blue-600">
            Optional Functionality: Encryption
        </h2>

		<h2 class="text-xl font-semibold text-gray-700 mb-3">Insert plaintext to encrypt</h2>
        <div class="mb-6">
            <textarea id="plaintextInput" rows="8" maxlength="5000" 
                      placeholder="Paste the ciphertext here. Frequency analysis will automatically detect the language and key (rotation)."
                      class="w-full p-4 border border-gray-300 rounded-lg focus:border-orange-500">
The ancient manuscript lay open on the oak table, its parchment thin and brittle with age. Inspector Davies leaned closer, his magnifying glass tracing the lines of unusual script. It wasn't Latin or Greek; it was clearly a cipher, a rudimentary substitution that pointed straight to a schoolboy's gameâ€”the Caesar shift. 'Elementary, my dear Watson,' he muttered, though no one else occupied the echoing silence of the archive room. The task, however, was far from trivial. A significant quantity of text was necessary to defeat the simplicity of the encoding. A short phrase might hide the key forever, demanding endless, frustrating trial and error.

Davies understood that the beauty of frequency analysis rests entirely on the law of large numbers. Every language possesses its own cryptographic fingerprint. In English, the letter 'E' reigns supreme, a constant monarch of the alphabet, followed closely by 'T', 'A', 'O', 'I', 'N', and 'S'. If the cryptographer could accurately calculate the frequency of every unique character appearing in the message, the highest count must, by statistical necessity, correspond to 'E' in the original plaintext. The offset between the most frequent character in the cipher text and 'E' would reveal the hidden key.

He began the tedious work, meticulously logging the occurrences of 'A' through 'Z'. The text, relating to a long-forgotten territorial dispute over a hidden quarry, was dense and rich with repeating patterns, a gift for his analytical mind. Soon, a dominant character emerged: 'X'. It occurred far more frequently than any other letter. 'X', therefore, must be the substituted form of 'E'. Counting the letters between 'E' and 'X' in the alphabet would expose the magnitude of the shift, unlocking not just this paragraph, but the entire, long-dormant conspiracy. The remaining characters would then cascade into sensible words, transforming the gibberish into coherent, compelling narrative evidence, finally giving voice to the silent pages.
            </textarea>
        </div>
        
        <!-- Encryption Key Input -->
        <div class="mb-5 flex items-center space-x-4">
            <label for="keyInput" class="text-base font-medium text-gray-700">
                Encryption Key (0-25):
            </label>
            <input type="number" id="keyInput" min="0" max="25" value="3"
                   class="w-20 p-2 border border-blue-300 rounded-lg text-center focus:border-blue-500">
        </div>
        
        <!-- ENCRYPT Button -->
        <button id="encryptButton" 
                class="w-full sm:w-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition duration-150 transform hover:scale-[1.01]">
            âœ¨ Encrypt
        </button>

       <div style="height: 50px;"></div>

        <!-- ENCRYPTED TEXT RESUL -->
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Encrypted text
            <!-- NUOVO PULSANTE COPIA -->
            <button class="copy-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-3 rounded-md text-sm transition" data-target="encryptedOutput">
                <span class="lucide lucide-copy w-4 h-4 inline-block mr-1"></span> Copia
            </button>
        </h2>
        <textarea id="encryptedOutput" rows="8" readonly
                  placeholder="The encrypted text will appear here, using the key found through frequency analysis."
                  class="w-full p-4 bg-green-50 border border-green-300 rounded-lg text-gray-700"></textarea>

        <div style="height: 100px;"></div>

        <!-- ENCRYPTED TEXT-->
        <h2 class="text-xl font-semibold text-gray-700 mb-3">Enter the Ciphertext to Analyze</h2>
        <div class="mb-6">
            <textarea id="ciphertextInput" rows="8" maxlength="5000" 
                      placeholder="Paste the ciphertext here. Frequency analysis will automatically detect the language and key (rotation)."
                      class="w-full p-4 border border-gray-300 rounded-lg focus:border-orange-500"></textarea>
        </div>
        <p>Supported languages: English, Italian, French and German</p>
        
        <!-- DECRYPT Button -->
        <button id="analyzeButton" 
                class="w-full sm:w-auto px-8 py-3 bg-orange-600 text-white font-bold rounded-lg shadow-md hover:bg-orange-700 transition duration-150 transform hover:scale-[1.01]">
            ðŸš€ Run Frequency Analisys and Decrypt
        </button>
        
        <hr class="my-8 border-t border-gray-200">

        <!--DECRYPTED TEXT Result -->
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Decryted Text</h2>
        <textarea id="decryptedOutput" rows="8" readonly
                  placeholder="The decrypted text will appear here, using the key found through frequency analysis."
                  class="w-full p-4 bg-green-50 border border-green-300 rounded-lg text-gray-700"></textarea>

        <!-- ANALYSIS DETAILS -->
        <h2 class="text-2xl font-bold text-gray-800 mt-8 mb-4">Analysis Details</h2>
        <div id="resultOutput" class="p-6 bg-yellow-50 rounded-lg border border-yellow-200">
            <p class="text-gray-600">The analysis results (Language, Rotation, Similarity Details) will be displayed here.</p>
        </div>

        <br>
        <p>Frequencies distances are computed using the <b>chi-squared distribution</b>:</p>
        <div style="text-align: center;">$$\chi^2 = \sum_{i=1}^{k} \frac{(O_i - E_i)^2}{E_i}$$</div>
        
        <hr class="my-10 border-t border-gray-200">
        
        <p class="mt-8 text-sm text-gray-500 text-center">
            Project developed in JavaScript for the statistical analysis of simple substitution ciphers.
        </p>

    </div>

    <!-- MESSAGGIO DI FEEDBACK COPIA (Fisso) -->
    <div id="copyFeedback" class="bg-blue-600 text-white p-3 rounded-lg shadow-xl flex items-center space-x-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check-circle"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></svg>
        <span>Testo copiato negli appunti!</span>
    </div>

    <!-- Link to the JavaScript file containing all the logic -->
    <script src="script.js"></script>

        <!-- Libreria per icone (aggiunta per l'icona "Copia") -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        // Inizializza le icone lucide (copia, ecc.)
        lucide.createIcons();

        document.addEventListener('DOMContentLoaded', () => {
            const copyButtons = document.querySelectorAll('.copy-btn');
            const feedbackMessage = document.getElementById('copyFeedback');

            copyButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const targetElement = document.getElementById(targetId);

                    if (targetElement) {
                        // 1. Usa l'API standard per copiare il testo
                        // Si usa document.execCommand('copy') come fallback/necessario in ambienti iFrame
                        const textToCopy = targetElement.value;
                        
                        const tempInput = document.createElement('textarea');
                        tempInput.value = textToCopy;
                        document.body.appendChild(tempInput);
                        tempInput.select();

                        try {
                            const successful = document.execCommand('copy');
                            if (successful) {
                                // Mostra feedback
                                feedbackMessage.classList.add('show');
                                setTimeout(() => {
                                    feedbackMessage.classList.remove('show');
                                }, 1500);
                            }
                        } catch (err) {
                            console.error('Errore durante la copia del testo:', err);
                            // Potresti aggiungere un feedback di errore qui
                        } finally {
                            document.body.removeChild(tempInput);
                        }
                    }
                });
            });

            if (typeof renderMathInElement !== 'undefined') {
                renderMathInElement(document.body);
            }
        });
    </script>
</body>
</html>
