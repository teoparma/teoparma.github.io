<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homework 3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .decryption-input {
            width: 2.5rem; /* 40px */
            text-align: center;
            border: 1px solid #10b981;
            text-transform: uppercase;
            font-weight: bold;
            padding: 0.25rem;
            border-radius: 0.375rem;
            transition: border-color 0.2s;
        }
        .decryption-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }
        .result-box {
            min-height: 4rem;
            white-space: pre-wrap;
            word-break: break-word;
            font-family: monospace;
            font-size: 1.05rem;
            max-height: 12rem;
            overflow-y: auto;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans p-4 sm:p-8">

    <div class="max-w-7xl mx-auto bg-white shadow-2xl rounded-xl p-6 sm:p-10">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-blue-600 mb-6 border-b-4 border-blue-100 pb-2">
            Cracking RSA Encrypted Text with Frequency Analysis
        </h1>
        <p class="text-gray-600 mb-8">
            Uses frequency analysis to decrypt the text. The decryption map is interactive.
        </p>

    <div class="mb-8 p-4 bg-yellow-50 rounded-lg border border-yellow-200 text-gray-700">
        <p class="mb-3">
            The methodology behind frequency analysis relies on the fact that in any language, each letter has its own <i>personality</i>. The most obvious trait that letters have is the <b>frequency</b> with which they appear in a language. Clearly in English the letter "Z" appears far less frequently than, say, "A".
        </p>
        <p class="mb-3">
            We can use this information to help us break a code given by a <i>Monoalphabetic Substitution Cipher</i>. This works because, if "e" has been encrypted to "X", then every "X" was an "e". Hence, the most common letter in the ciphertext should be "X".
            Thus, if we intercept a message, and the most common letter is "P", we can guess that "P" was used to encrypt "e", and thus replace all the "P"'s with "e". Of course, not every text has exactly the same frequency, and as seen above, "t" and "a" have high frequencies too, so it could be that "P" was one of those. However, it is unlikely to be "z" as this is rare in the English Language. By repeating this process we can make good progress in breaking a message.
        </p>
        <p class="mb-3">
            If we were to just put all the letters in order, and replace them as in the frequencies, it would likely produce jibberish. The codebreaker has to use other "personality traits" of the letters to decrypt the message. This may include looking at common **pairs of letters (or digraphs)**: there aren't many 2 letter words; there are only a few letters which appear as doubles (SS, EE, TT, OO and FF being the most common). There are only two sensical words made of a single letter in English. Other common words also start to appear as you make some substitutions. For example "tKe" might appear frequently after making substitutions for "t" and "e". This is very likely to be "the", a very common word in English.
        </p>
        <p class="mb-0">
            The process of frequency analysis uses various subtle properties of the language, and for this reason, it is near impossible to have a computer do all the work. Inevitably, an element of <u>human input is necessary</u> in this process to make educated decisions about which letters to substitute.
        </p>
        <p><a href="https://crypto.interactive-maths.com/frequency-analysis-breaking-the-code.html">[1]</a></p>
    </div>

        <!-- INPUT AND ENCRYPTION -->
        <section class="mb-10 p-6 bg-gray-50 rounded-lg border">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">Input and Setup</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="md:col-span-2">
                    <label for="plaintext" class="block text-sm font-medium text-gray-700 mb-1">Plaintext:</label>
                    <textarea id="plaintext" rows="4" class="w-full border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 p-3 shadow-inner text-gray-700">THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG</textarea>
                </div>
                <div>
                    <p class="text-sm font-medium text-gray-700 mb-2">RSA prime numers:</p>
                    <div class="flex items-center space-x-4 mb-2">
                        <label for="p" class="text-gray-600">p:</label>
                        <input type="number" id="p" value="17" class="w-20 border-gray-300 rounded-lg text-center" min="2" onchange="updateModulusN()">
                        <label for="q" class="text-gray-600">q:</label>
                        <input type="number" id="q" value="19" class="w-20 border-gray-300 rounded-lg text-center" min="2" onchange="updateModulusN()">
                    </div>
                    <p class="text-sm text-gray-500">Modulus N = <span id="modulus_n" class="font-bold text-gray-800">3127</span></p>
                </div>
            </div>
            
            <button onclick="runAnalysis()" class="mt-4 w-full md:w-auto px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition duration-150 ease-in-out">
                Encrypt and Run Analysis
            </button>
        </section>

        <!-- OUTPUT AND INTERACTIVE ANALYSIS -->
        <div id="analysis_section" style="display: none;">
            <section class="mb-10">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Ciphertext</h2>
                <div id="ciphertext_display" class="result-box fixed-height-box p-4 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-800 overflow-x-auto">
                    ...
                </div>
            </section>

            <!-- MONOGRAM ANALYSIS AND MAPPING -->
            <section class="mb-10">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Monograms Analysis and Decryption Map</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
                    <div class="lg:col-span-1 xl:col-span-2 bg-white p-4 rounded-lg shadow-md border border-gray-200 overflow-x-auto">
                        <h3 class="text-lg font-bold text-gray-700 mb-3">Frequency Comparison for Cryptanalisys</h3>
                        <table id="combined_freq_table" class="min-w-full divide-y divide-gray-200 text-sm"></table>
                    </div>
                    
                    <!-- Decryption Map -->
                    <div class="lg:col-span-1 bg-white p-4 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-lg font-bold text-gray-700 mb-3">Decryptio Map (interactive)</h3>
                        <table id="decryption_map_table" class="min-w-full divide-y divide-gray-200 text-sm">
                            <!-- Content Generated with JS -->
                        </table>
                    </div>
                </div>
            </section>

            <!-- N-GRAMS ANALYSIS -->
            <section class="mb-10">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Analysis of Bigrams, Trigrams and Doubles</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-sm">
                    
                    <div class="bg-white p-4 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-lg font-bold text-gray-700 mb-3">Most Frequent 2-Grams</h3>
                        <table id="enc_bigrams_table" class="min-w-full divide-y divide-gray-200 mb-3"></table>
                    </div>
                    
                    <div class="bg-white p-4 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-lg font-bold text-gray-700 mb-3">Most Frequent 3-Grams</h3>
                        <table id="enc_trigrams_table" class="min-w-full divide-y divide-gray-200 mb-3"></table>
                    </div>

                    <div class="bg-white p-4 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-lg font-bold text-gray-700 mb-3">Most Frequent Doubles</h3>
                        <table id="enc_doubles_table" class="min-w-full divide-y divide-gray-200 mb-3"></table>
                        </div>
                </div>
            </section>

            <!-- CUSTOM N-GRAMS ANALYSIS -->
            <section class="mb-10" id="custom_ngram_section" style="display: none;">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Custom N-Grams Analysis</h2>
                <div class="bg-white p-4 rounded-lg shadow-md border border-gray-200">
                    <div class="flex items-center space-x-4 mb-4">
                        <label for="ngram_n_input" class="text-sm font-medium text-gray-700">Select N:</label>
                        <input type="number" id="ngram_n_input" value="4" min="1" max="10" class="w-20 border-gray-300 rounded-lg text-center">
                        <button onclick="generateCustomNGrams()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition duration-150 ease-in-out text-sm">
                            Generate Table
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table id="custom_ngram_table" class="min-w-full divide-y divide-gray-200 text-sm">
                            <!-- Content Generated with JS -->
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- FINAL DECRYPTED TEXT -->
            <section>
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Decrypted Text (Interactive)</h2>
                <div id="decrypted_text_output" class="result-box p-4 bg-emerald-50 border-2 border-emerald-400 rounded-lg text-gray-900 font-semibold shadow-inner">
                </div>
            </section>
        </div>
    </div>

<script src="script.js"></script>
</body>
</html>
